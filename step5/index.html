!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title> My Experiment </title>
	<script src = "https://tyoon.net/webexp/jspsych/jspsych.js"></script>
	<script src = "https://tyoon.net/webexp/jspsych/plugins/jspsych-html-button-response.js"></script>
	<script src = "https://tyoon.net/webexp/jspsych/plugins/jspsych-html-keyboard-response.js"></script>
	<script src = "https://tyoon.net/webexp/jspsych/plugins/jspsych-instructions.js"></script>
	<script src = "https://tyoon.net/webexp/jspsych/plugins/jspsych-image-keyboard-response.js"></script>
	<script src="https://tyoon.net/webexp/jspsych/plugins/jspsych-audio-keyboard-response.js"></script>
	<script src="https://tyoon.net/webexp/jspsych/plugins/jspsych-audio-button-response.js"></script>


	<link href = "https://tyoon.net/webexp/jspsych/css/jspsych.css" rel="stylesheet" type="text/css">
	<style>
		*{
			box-sizing: border-box;
		}
		#large{
			border:50px solid white;
		}
	</style>

</head>

<body>
</body>
<script>

  // media preloading
	var audio = [
		'../sounds/a_bark.mp3',
		'../sounds/a_straw.mp3'
	];


	// Welcome
	var welcome_block = {
		data: {
			screen_id: "welcome"
		},
		type: "html-button-response",
		stimulus: '<p id="demo"></p>Welcome to the experiment' + '<button onclick="document.getElementById("demo").innerHTML=Date()">The time is?</button>',
		choices: ["Click here to continue"],

	};



	// Instructions
	var instruction_block = {
		data: {
			screen_id: "instructions"
		},
		type: "instructions",
		pages: [
			"<p>In this experiment, a circle will appear in the middle of the screen.</p>" +
			"<p>If the color of the circle is <b>blue</b>, press the <b>left</b> key.</p>" +
			"<p>If the color of the circle is <b>orange</b>, press the <b>right</b> key.</p>",
			"We will begin with some practice"
			],
		show_clickable_nav: true,
	};


	/* STIMULI */
	// Put in the names of the audio files you want as stimuli, preceded by the relative file path.
	// In this example, the stimuli are all in a folder called 'sound'.
	// (Note that jsPsych is not set up to play multiple sound files per trial, so one solution
	// is to concatenate all sound files per trial into a single sound file.
	// You can use the Praat script "concatenate_sound_pairs_from_table.praat" to concatenate sound files for an AX task
	// and "concatenate_sound_triad_from_table.praat" to concatenate sound files for an AXB/ABX/oddity task.
	// See the priming example script for another solution.)
	// Any information you want recorded, such as the condition or correct response, can be added to a trial as data.
	var ax_stimuli = [
			{ stimulus: '../sounds/a_straw.mp3', data: { answer: 'different', correct_response: 'l', condition: 'tap-trill' } },
			{ stimulus: '../sounds/a_bark.mp3', data: { answer: 'different', correct_response: 'l', condition: 'tap-trill' } }
	];

	/* TRIALS */
	// This section determines what happens during each trial.
	var ax_button_trials = {

			// The audio-button-response plugin plays (concatenated) audio stimuli to the participant, and asks them to respond via on-screen buttons.
			// See https://www.jspsych.org/plugins/jspsych-audio-button-response/ for additional parameter options.
			type: 'audio-button-response',

			// The stimuli are labeled with 'stimulus' and the additional data as 'data' in whatever array is later specified
			// as the timeline variable in the procedure (e.g. 'ax_stimuli' in this case).
			stimulus: jsPsych.timelineVariable('stimulus'),
			data: jsPsych.timelineVariable('data'),

			// There will be two buttons that appear on the screen, which say 'same' and 'different'.
			choices: ['same', 'different'],

			// Participants have 6000 ms to respond, otherwise they will timeout (which is recorded as -1).
			trial_duration: 6000,

			// At the end of the trial, record the following data:
			on_finish: function (data) {

					// If the participant pressed the first button (i.e. button 0), which is 'same', and the answer specified in 'answer'
					// for that stimulus in the ax_stimuli variable was 'same' ...
					if ((data.button_pressed == 0) && (data.answer == 'same')) {

							// ...then record TRUE in the 'correct' column in the results.
							jsPsych.data.addDataToLastTrial({ correct: true });

					// If the participant pressed the second button (i.e. button 1), which is 'different', and the answer specified in 'answer'
					// for that stimulus in the ax_stimuli variable was 'different' ...
					} else if ((data.button_pressed == 1) && (data.answer == 'different')) {

							// ...then record TRUE in the 'correct' column in the results.
							jsPsych.data.addDataToLastTrial({ correct: true });

					// If the participant did not respond within the alloted time, then record 'timeout' in the 'correct' column in the results.
					} else if (data.button_pressed == -1) {
							jsPsych.data.addDataToLastTrial({ correct: 'timeout' });

					// Otherwise, the participant must have made an incorrect response, so record FALSE in the 'correct' column in the results.
					} else {
							jsPsych.data.addDataToLastTrial({ correct: false });
					}
			}
	}

	/* PROCEDURE */
	var ax_button_procedure = {

			// Each trial should follow the format specified in the 'trials' variable.
			timeline: [ax_button_trials],

			// Stimuli and associated data should come from the array called 'ax_stimuli'.
			timeline_variables: ax_stimuli,

			// This randomizes the presentation of the trials.  Otherwise, they are presented in the same order in which they appear in 'ax_stimuli'.
			randomize_order: true
	}


	var breaktime = {
    type: 'html-keyboard-response',
    stimulus: '잠깐 쉬도록 하겠습니다. 계속하려면 아무 키나 누르기 바랍니다.',
    post_trial_gap: 0,
    on_finish: function(){
      jsPsych.pauseExperiment();
      setTimeout(jsPsych.resumeExperiment, 1000);
    }
  }


	// Debrief

  var debrief_block = {
    type: "html-keyboard-response",
    stimulus: function() {

      var trials = jsPsych.data.get().filter({condition: 'tap-trill'});
      var correct_trials = trials.filter({correct: true});
      var accuracy = Math.round(correct_trials.count() / trials.count() * 100);
      var rt = Math.round(correct_trials.select('rt').mean());

      return "<p>You responded correctly on "+accuracy+"% of the trials.</p>"+
      "<p>Your average response time was "+rt+"ms.</p>"+
      "<p>Press any key to complete the experiment. Thank you!</p>";

    }
  };

	// timeline
	timeline = [];

	//timeline.push(welcome_block);
	timeline.push(instruction_block);
	//timeline.push(orange_trial);


	// Note that only the procedure variable is added to the overall experiment timeline, and not the stimuli variable or the trials variable.
	timeline.push(ax_button_procedure);

	timeline.push(breaktime);
	timeline.push(debrief_block);

	// start experiment
	jsPsych.init({
		timeline: timeline,
		preload_audio: audio,
		on_finish: function(){
			jsPsych.data.displayData('json')
		}
	})

</script>
</html>
